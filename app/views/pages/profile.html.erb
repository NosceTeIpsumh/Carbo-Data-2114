



<div class="profile-page">
  <div class="container py-5">

    <!-- Profile Header Section -->
    <div class="profile-header">
      <div class="row align-items-center">

        <!-- Avatar -->
        <div class="col-12 col-md-4 text-center text-md-start mb-4 mb-md-0">
          <div class="profile-avatar-wrapper">
            <% if current_user.respond_to?(:photo) && current_user.photo.attached? %>
              <%= image_tag current_user.photo, alt: current_user.profile_name, class: "profile-avatar" %>
            <% elsif current_user.respond_to?(:avatar) && current_user.avatar.present? %>
              <%= image_tag current_user.avatar, alt: current_user.profile_name, class: "profile-avatar" %>
            <% else %>
              <div class="profile-avatar-placeholder">
                <%= (current_user.profile_name || current_user.email.split('@').first).first.upcase %>
              </div>
            <% end %>
          </div>
        </div>

        <!-- Profile Info & Stats -->
        <div class="col-12 col-md-8">
          <div class="profile-info">

            <!-- Username & Edit Button -->
            <div class="d-flex align-items-center justify-content-between mb-3 flex-wrap gap-3">
              <h1 class="profile-username mb-0"><%= current_user.profile_name || current_user.email.split('@').first %></h1>

              <%= link_to "Edit Profile", edit_user_registration_path, class: "btn btn-edit-profile" %>
            </div>

            <!-- Stats -->
            <div class="profile-stats mb-4">
              <div class="stat-item">
                <span class="stat-number"><%= current_user.recipes.count %></span>
                <span class="stat-label">Recipes</span>
              </div>
              <div class="stat-item">
                <span class="stat-number"><%= current_user.items.count %></span>
                <span class="stat-label">Products</span>
              </div>
              <div class="stat-item">
                <span class="stat-number">28</span>
                <span class="stat-label">Followers</span>
              </div>
            </div>

            <!-- Bio -->
            <% if current_user.respond_to?(:bio) && current_user.bio.present? %>
              <div class="profile-bio">
                <p class="mb-0">
                  <%= current_user.bio %>
                </p>
              </div>
            <% end %>

          </div>
        </div>

      </div>
    </div>

    <!-- Tabs Navigation -->
    <div class="profile-tabs-wrapper mt-5">
      <ul class="nav nav-tabs profile-tabs" id="profileTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="recipes-tab" data-bs-toggle="tab" data-bs-target="#recipes" type="button" role="tab" aria-controls="recipes" aria-selected="true">
            <i class="fas fa-utensils me-2"></i>Carboposts
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="products-tab" data-bs-toggle="tab" data-bs-target="#products" type="button" role="tab" aria-controls="products" aria-selected="false">
            <i class="fas fa-box me-2"></i>Favourites
          </button>
        </li>
      </ul>

      <!-- Tab Content -->
      <div class="tab-content profile-tab-content" id="profileTabsContent">

        <!-- Recipes Tab -->
        <div class="tab-pane fade show active" id="recipes" role="tabpanel" aria-labelledby="recipes-tab">
          <div class="row g-4 mt-2">
            <% if current_user.recipes.any? %>
              <% current_user.recipes.each do |recipe| %>
                <div class="col-6 col-lg-3">
                  <%= link_to recipe_path(recipe), class: "profile-card-link" do %>
                    <div class="profile-card">
                      <div class="profile-card-placeholder">
                        <i class="fas fa-utensils"></i>
                      </div>
                      <div class="profile-card-overlay">
                        <div class="profile-card-stats">
                          <span><i class="fas fa-heart"></i> 30</span>
                          <span><i class="fas fa-comment"></i> 100</span>
                        </div>
                      </div>
                      <div class="profile-card-title">
                        <%= recipe.name %>
                      </div>
                    </div>
                  <% end %>
                </div>
              <% end %>
            <% else %>
              <div class="col-12">
                <div class="empty-state">
                  <i class="fas fa-utensils mb-3"></i>
                  <p>No recipes yet</p>
                  <%= link_to "Create your first recipe", new_recipe_path, class: "btn button-default" %>
                </div>
              </div>
            <% end %>
          </div>
        </div>

        <!-- Products Tab -->
        <div class="tab-pane fade" id="products" role="tabpanel" aria-labelledby="products-tab">
          <div class="row g-4 mt-2">
            <% if current_user.items.any? %>
              <% current_user.items.each do |item| %>
                <div class="col-6 col-lg-3">
                  <%= link_to item_path(item), class: "profile-card-link" do %>
                    <div class="profile-card">
                      <div class="profile-card-placeholder">
                        <i class="fas fa-box"></i>
                      </div>
                      <div class="profile-card-overlay">
                        <div class="profile-card-stats">
                          <span><i class="fas fa-heart"></i> 30</span>
                          <span><i class="fas fa-comment"></i> 100</span>
                        </div>
                      </div>
                      <div class="profile-card-title">
                        <%= item.name %>
                      </div>
                    </div>
                  <% end %>
                </div>
              <% end %>
            <% else %>
              <div class="col-12">
                <div class="empty-state">
                  <i class="fas fa-box mb-3"></i>
                  <p>No products yet</p>
                  <%= link_to "Add your first product", new_item_path, class: "btn button-default" %>
                </div>
              </div>
            <% end %>
          </div>
        </div>

      </div>
    </div>

  </div>
</div>
